{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hp\\\\Desktop\\\\Cloud_Project\\\\frontend\\\\src\\\\components\\\\post.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { likePost, unlikePost, getPostDetails } from '../services/socialService';\nimport CommentSection from './comment-section';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Post({\n  postId,\n  user,\n  image,\n  content,\n  createdAt,\n  likesCount = 0,\n  commentsCount = 0,\n  isLiked = false,\n  userLikes = [],\n  onUpdate\n}) {\n  _s();\n  const [liked, setLiked] = useState(isLiked);\n  const [likes, setLikes] = useState(likesCount);\n  const [showComments, setShowComments] = useState(false);\n  const [comments, setComments] = useState([]);\n  const [commentsTotal, setCommentsTotal] = useState(commentsCount);\n\n  // V√©rifier si l'utilisateur a lik√© ce post\n  useEffect(() => {\n    const currentUserId = localStorage.getItem('userId');\n    if (currentUserId && userLikes) {\n      setLiked(userLikes.includes(currentUserId));\n    }\n  }, [userLikes]);\n\n  // Calculer le temps √©coul√©\n  const getTimeAgo = timestamp => {\n    if (!timestamp) return '';\n    const now = new Date();\n    const postDate = new Date(timestamp);\n    const seconds = Math.floor((now - postDate) / 1000);\n    if (seconds < 60) return `Il y a ${seconds}s`;\n    const minutes = Math.floor(seconds / 60);\n    if (minutes < 60) return `Il y a ${minutes}min`;\n    const hours = Math.floor(minutes / 60);\n    if (hours < 24) return `Il y a ${hours}h`;\n    const days = Math.floor(hours / 24);\n    return `Il y a ${days}j`;\n  };\n\n  // G√©rer le like/unlike\n  const handleLike = async () => {\n    if (!postId) return;\n    try {\n      if (liked) {\n        await unlikePost(postId);\n        setLikes(prev => prev - 1);\n        setLiked(false);\n      } else {\n        await likePost(postId);\n        setLikes(prev => prev + 1);\n        setLiked(true);\n      }\n      if (onUpdate) {\n        onUpdate();\n      }\n    } catch (error) {\n      console.error('Erreur lors du like:', error);\n    }\n  };\n\n  // Charger les commentaires\n  const loadComments = async () => {\n    if (!postId) return;\n    try {\n      const postDetails = await getPostDetails(postId);\n      setComments(postDetails.comments || []);\n      setCommentsTotal(postDetails.commentsCount || 0);\n    } catch (error) {\n      console.error('Erreur lors du chargement des commentaires:', error);\n    }\n  };\n\n  // Toggle affichage des commentaires\n  const toggleComments = async () => {\n    if (!showComments) {\n      await loadComments();\n    }\n    setShowComments(!showComments);\n  };\n\n  // Callback apr√®s ajout d'un commentaire\n  const handleCommentAdded = async () => {\n    await loadComments();\n    setCommentsTotal(prev => prev + 1);\n    if (onUpdate) {\n      onUpdate();\n    }\n  };\n\n  // Initiales de l'utilisateur\n  const initials = (user || 'U').substring(0, 2).toUpperCase();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-red-800 rounded-md p-4 mb-4 text-white\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-10 h-10 rounded-full bg-red-600 flex items-center justify-center font-bold mr-3\",\n        children: initials\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-bold\",\n          children: user || 'Utilisateur'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-red-200\",\n          children: getTimeAgo(createdAt)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"my-2\",\n      children: content\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this), image && /*#__PURE__*/_jsxDEV(\"img\", {\n      src: image,\n      alt: \"post\",\n      className: \"rounded-md mt-2\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex gap-4 mt-3 text-sm border-t border-red-700 pt-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleLike,\n        className: `flex items-center gap-1 hover:text-red-300 transition-colors ${liked ? 'text-pink-300' : ''}`,\n        children: [liked ? '‚ù§Ô∏è' : 'ü§ç', \" \", likes]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleComments,\n        className: `flex items-center gap-1 hover:text-red-300 transition-colors ${showComments ? 'text-red-300' : ''}`,\n        children: [\"\\uD83D\\uDCAC \", commentsTotal]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), showComments && /*#__PURE__*/_jsxDEV(CommentSection, {\n      postId: postId,\n      comments: comments,\n      onCommentAdded: handleCommentAdded\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n}\n_s(Post, \"nqyKjrp7EYqOFgNsbz0nZgM9s/c=\");\n_c = Post;\nvar _c;\n$RefreshReg$(_c, \"Post\");","map":{"version":3,"names":["useState","useEffect","likePost","unlikePost","getPostDetails","CommentSection","jsxDEV","_jsxDEV","Post","postId","user","image","content","createdAt","likesCount","commentsCount","isLiked","userLikes","onUpdate","_s","liked","setLiked","likes","setLikes","showComments","setShowComments","comments","setComments","commentsTotal","setCommentsTotal","currentUserId","localStorage","getItem","includes","getTimeAgo","timestamp","now","Date","postDate","seconds","Math","floor","minutes","hours","days","handleLike","prev","error","console","loadComments","postDetails","toggleComments","handleCommentAdded","initials","substring","toUpperCase","className","children","fileName","_jsxFileName","lineNumber","columnNumber","src","alt","onClick","onCommentAdded","_c","$RefreshReg$"],"sources":["C:/Users/Hp/Desktop/Cloud_Project/frontend/src/components/post.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { likePost, unlikePost, getPostDetails } from '../services/socialService';\r\nimport CommentSection from './comment-section';\r\n\r\nexport default function Post({ \r\n  postId, \r\n  user, \r\n  image, \r\n  content, \r\n  createdAt,\r\n  likesCount = 0,\r\n  commentsCount = 0,\r\n  isLiked = false,\r\n  userLikes = [],\r\n  onUpdate\r\n}) {\r\n  const [liked, setLiked] = useState(isLiked);\r\n  const [likes, setLikes] = useState(likesCount);\r\n  const [showComments, setShowComments] = useState(false);\r\n  const [comments, setComments] = useState([]);\r\n  const [commentsTotal, setCommentsTotal] = useState(commentsCount);\r\n\r\n  // V√©rifier si l'utilisateur a lik√© ce post\r\n  useEffect(() => {\r\n    const currentUserId = localStorage.getItem('userId');\r\n    if (currentUserId && userLikes) {\r\n      setLiked(userLikes.includes(currentUserId));\r\n    }\r\n  }, [userLikes]);\r\n\r\n  // Calculer le temps √©coul√©\r\n  const getTimeAgo = (timestamp) => {\r\n    if (!timestamp) return '';\r\n    \r\n    const now = new Date();\r\n    const postDate = new Date(timestamp);\r\n    const seconds = Math.floor((now - postDate) / 1000);\r\n\r\n    if (seconds < 60) return `Il y a ${seconds}s`;\r\n    const minutes = Math.floor(seconds / 60);\r\n    if (minutes < 60) return `Il y a ${minutes}min`;\r\n    const hours = Math.floor(minutes / 60);\r\n    if (hours < 24) return `Il y a ${hours}h`;\r\n    const days = Math.floor(hours / 24);\r\n    return `Il y a ${days}j`;\r\n  };\r\n\r\n  // G√©rer le like/unlike\r\n  const handleLike = async () => {\r\n    if (!postId) return;\r\n\r\n    try {\r\n      if (liked) {\r\n        await unlikePost(postId);\r\n        setLikes(prev => prev - 1);\r\n        setLiked(false);\r\n      } else {\r\n        await likePost(postId);\r\n        setLikes(prev => prev + 1);\r\n        setLiked(true);\r\n      }\r\n      \r\n      if (onUpdate) {\r\n        onUpdate();\r\n      }\r\n    } catch (error) {\r\n      console.error('Erreur lors du like:', error);\r\n    }\r\n  };\r\n\r\n  // Charger les commentaires\r\n  const loadComments = async () => {\r\n    if (!postId) return;\r\n\r\n    try {\r\n      const postDetails = await getPostDetails(postId);\r\n      setComments(postDetails.comments || []);\r\n      setCommentsTotal(postDetails.commentsCount || 0);\r\n    } catch (error) {\r\n      console.error('Erreur lors du chargement des commentaires:', error);\r\n    }\r\n  };\r\n\r\n  // Toggle affichage des commentaires\r\n  const toggleComments = async () => {\r\n    if (!showComments) {\r\n      await loadComments();\r\n    }\r\n    setShowComments(!showComments);\r\n  };\r\n\r\n  // Callback apr√®s ajout d'un commentaire\r\n  const handleCommentAdded = async () => {\r\n    await loadComments();\r\n    setCommentsTotal(prev => prev + 1);\r\n    if (onUpdate) {\r\n      onUpdate();\r\n    }\r\n  };\r\n\r\n  // Initiales de l'utilisateur\r\n  const initials = (user || 'U').substring(0, 2).toUpperCase();\r\n\r\n  return (\r\n    <div className=\"bg-red-800 rounded-md p-4 mb-4 text-white\">\r\n      {/* Header du post */}\r\n      <div className=\"flex items-center mb-3\">\r\n        <div className=\"w-10 h-10 rounded-full bg-red-600 flex items-center justify-center font-bold mr-3\">\r\n          {initials}\r\n        </div>\r\n        <div>\r\n          <div className=\"font-bold\">{user || 'Utilisateur'}</div>\r\n          <div className=\"text-xs text-red-200\">{getTimeAgo(createdAt)}</div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Contenu */}\r\n      <p className=\"my-2\">{content}</p>\r\n      \r\n      {/* Image si pr√©sente */}\r\n      {image && <img src={image} alt=\"post\" className=\"rounded-md mt-2\" />}\r\n      \r\n      {/* Actions */}\r\n      <div className=\"flex gap-4 mt-3 text-sm border-t border-red-700 pt-3\">\r\n        <button \r\n          onClick={handleLike}\r\n          className={`flex items-center gap-1 hover:text-red-300 transition-colors ${liked ? 'text-pink-300' : ''}`}\r\n        >\r\n          {liked ? '‚ù§Ô∏è' : 'ü§ç'} {likes}\r\n        </button>\r\n        <button \r\n          onClick={toggleComments}\r\n          className={`flex items-center gap-1 hover:text-red-300 transition-colors ${showComments ? 'text-red-300' : ''}`}\r\n        >\r\n          üí¨ {commentsTotal}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Section commentaires */}\r\n      {showComments && (\r\n        <CommentSection \r\n          postId={postId}\r\n          comments={comments}\r\n          onCommentAdded={handleCommentAdded}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,QAAQ,EAAEC,UAAU,EAAEC,cAAc,QAAQ,2BAA2B;AAChF,OAAOC,cAAc,MAAM,mBAAmB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/C,eAAe,SAASC,IAAIA,CAAC;EAC3BC,MAAM;EACNC,IAAI;EACJC,KAAK;EACLC,OAAO;EACPC,SAAS;EACTC,UAAU,GAAG,CAAC;EACdC,aAAa,GAAG,CAAC;EACjBC,OAAO,GAAG,KAAK;EACfC,SAAS,GAAG,EAAE;EACdC;AACF,CAAC,EAAE;EAAAC,EAAA;EACD,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGrB,QAAQ,CAACgB,OAAO,CAAC;EAC3C,MAAM,CAACM,KAAK,EAAEC,QAAQ,CAAC,GAAGvB,QAAQ,CAACc,UAAU,CAAC;EAC9C,MAAM,CAACU,YAAY,EAAEC,eAAe,CAAC,GAAGzB,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAAC0B,QAAQ,EAAEC,WAAW,CAAC,GAAG3B,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAAC4B,aAAa,EAAEC,gBAAgB,CAAC,GAAG7B,QAAQ,CAACe,aAAa,CAAC;;EAEjE;EACAd,SAAS,CAAC,MAAM;IACd,MAAM6B,aAAa,GAAGC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;IACpD,IAAIF,aAAa,IAAIb,SAAS,EAAE;MAC9BI,QAAQ,CAACJ,SAAS,CAACgB,QAAQ,CAACH,aAAa,CAAC,CAAC;IAC7C;EACF,CAAC,EAAE,CAACb,SAAS,CAAC,CAAC;;EAEf;EACA,MAAMiB,UAAU,GAAIC,SAAS,IAAK;IAChC,IAAI,CAACA,SAAS,EAAE,OAAO,EAAE;IAEzB,MAAMC,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC;IACtB,MAAMC,QAAQ,GAAG,IAAID,IAAI,CAACF,SAAS,CAAC;IACpC,MAAMI,OAAO,GAAGC,IAAI,CAACC,KAAK,CAAC,CAACL,GAAG,GAAGE,QAAQ,IAAI,IAAI,CAAC;IAEnD,IAAIC,OAAO,GAAG,EAAE,EAAE,OAAO,UAAUA,OAAO,GAAG;IAC7C,MAAMG,OAAO,GAAGF,IAAI,CAACC,KAAK,CAACF,OAAO,GAAG,EAAE,CAAC;IACxC,IAAIG,OAAO,GAAG,EAAE,EAAE,OAAO,UAAUA,OAAO,KAAK;IAC/C,MAAMC,KAAK,GAAGH,IAAI,CAACC,KAAK,CAACC,OAAO,GAAG,EAAE,CAAC;IACtC,IAAIC,KAAK,GAAG,EAAE,EAAE,OAAO,UAAUA,KAAK,GAAG;IACzC,MAAMC,IAAI,GAAGJ,IAAI,CAACC,KAAK,CAACE,KAAK,GAAG,EAAE,CAAC;IACnC,OAAO,UAAUC,IAAI,GAAG;EAC1B,CAAC;;EAED;EACA,MAAMC,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAI,CAACpC,MAAM,EAAE;IAEb,IAAI;MACF,IAAIW,KAAK,EAAE;QACT,MAAMjB,UAAU,CAACM,MAAM,CAAC;QACxBc,QAAQ,CAACuB,IAAI,IAAIA,IAAI,GAAG,CAAC,CAAC;QAC1BzB,QAAQ,CAAC,KAAK,CAAC;MACjB,CAAC,MAAM;QACL,MAAMnB,QAAQ,CAACO,MAAM,CAAC;QACtBc,QAAQ,CAACuB,IAAI,IAAIA,IAAI,GAAG,CAAC,CAAC;QAC1BzB,QAAQ,CAAC,IAAI,CAAC;MAChB;MAEA,IAAIH,QAAQ,EAAE;QACZA,QAAQ,CAAC,CAAC;MACZ;IACF,CAAC,CAAC,OAAO6B,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;IAC9C;EACF,CAAC;;EAED;EACA,MAAME,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC/B,IAAI,CAACxC,MAAM,EAAE;IAEb,IAAI;MACF,MAAMyC,WAAW,GAAG,MAAM9C,cAAc,CAACK,MAAM,CAAC;MAChDkB,WAAW,CAACuB,WAAW,CAACxB,QAAQ,IAAI,EAAE,CAAC;MACvCG,gBAAgB,CAACqB,WAAW,CAACnC,aAAa,IAAI,CAAC,CAAC;IAClD,CAAC,CAAC,OAAOgC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,6CAA6C,EAAEA,KAAK,CAAC;IACrE;EACF,CAAC;;EAED;EACA,MAAMI,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI,CAAC3B,YAAY,EAAE;MACjB,MAAMyB,YAAY,CAAC,CAAC;IACtB;IACAxB,eAAe,CAAC,CAACD,YAAY,CAAC;EAChC,CAAC;;EAED;EACA,MAAM4B,kBAAkB,GAAG,MAAAA,CAAA,KAAY;IACrC,MAAMH,YAAY,CAAC,CAAC;IACpBpB,gBAAgB,CAACiB,IAAI,IAAIA,IAAI,GAAG,CAAC,CAAC;IAClC,IAAI5B,QAAQ,EAAE;MACZA,QAAQ,CAAC,CAAC;IACZ;EACF,CAAC;;EAED;EACA,MAAMmC,QAAQ,GAAG,CAAC3C,IAAI,IAAI,GAAG,EAAE4C,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;EAE5D,oBACEhD,OAAA;IAAKiD,SAAS,EAAC,2CAA2C;IAAAC,QAAA,gBAExDlD,OAAA;MAAKiD,SAAS,EAAC,wBAAwB;MAAAC,QAAA,gBACrClD,OAAA;QAAKiD,SAAS,EAAC,mFAAmF;QAAAC,QAAA,EAC/FJ;MAAQ;QAAAK,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eACNtD,OAAA;QAAAkD,QAAA,gBACElD,OAAA;UAAKiD,SAAS,EAAC,WAAW;UAAAC,QAAA,EAAE/C,IAAI,IAAI;QAAa;UAAAgD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACxDtD,OAAA;UAAKiD,SAAS,EAAC,sBAAsB;UAAAC,QAAA,EAAEvB,UAAU,CAACrB,SAAS;QAAC;UAAA6C,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAChE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAGNtD,OAAA;MAAGiD,SAAS,EAAC,MAAM;MAAAC,QAAA,EAAE7C;IAAO;MAAA8C,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EAGhClD,KAAK,iBAAIJ,OAAA;MAAKuD,GAAG,EAAEnD,KAAM;MAACoD,GAAG,EAAC,MAAM;MAACP,SAAS,EAAC;IAAiB;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAGpEtD,OAAA;MAAKiD,SAAS,EAAC,sDAAsD;MAAAC,QAAA,gBACnElD,OAAA;QACEyD,OAAO,EAAEnB,UAAW;QACpBW,SAAS,EAAE,gEAAgEpC,KAAK,GAAG,eAAe,GAAG,EAAE,EAAG;QAAAqC,QAAA,GAEzGrC,KAAK,GAAG,IAAI,GAAG,IAAI,EAAC,GAAC,EAACE,KAAK;MAAA;QAAAoC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtB,CAAC,eACTtD,OAAA;QACEyD,OAAO,EAAEb,cAAe;QACxBK,SAAS,EAAE,gEAAgEhC,YAAY,GAAG,cAAc,GAAG,EAAE,EAAG;QAAAiC,QAAA,GACjH,eACI,EAAC7B,aAAa;MAAA;QAAA8B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACX,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC,EAGLrC,YAAY,iBACXjB,OAAA,CAACF,cAAc;MACbI,MAAM,EAAEA,MAAO;MACfiB,QAAQ,EAAEA,QAAS;MACnBuC,cAAc,EAAEb;IAAmB;MAAAM,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACpC,CACF;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV;AAAC1C,EAAA,CAhJuBX,IAAI;AAAA0D,EAAA,GAAJ1D,IAAI;AAAA,IAAA0D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}