{"ast":null,"code":"import { AZURE_FUNCTIONS } from '../config/config';\n\n// Optionnel: clé d'accès de la Function (si auth level = Function)\n// Doit être définie dans un fichier .env du dossier frontend\n// Exemple: REACT_APP_AZURE_FUNC_KEY=xxxxxxxxxxxxxxxx\nconst FUNCTION_KEY = process.env.REACT_APP_AZURE_FUNC_KEY;\n\n/**\r\n * Envoie un email de bienvenue via l'Azure Function\r\n * N'échoue pas le flux d'inscription si l'appel échoue.\r\n */\nexport async function sendWelcomeEmail(email, name) {\n  try {\n    // Construire l'URL avec éventuellement la clé\n    const url = FUNCTION_KEY ? `${AZURE_FUNCTIONS.WELCOME_EMAIL}?code=${encodeURIComponent(FUNCTION_KEY)}` : AZURE_FUNCTIONS.WELCOME_EMAIL;\n    const response = await fetch(url, {\n      method: 'POST',\n      // Certaines Functions acceptent la clé via header\n      headers: {\n        'Content-Type': 'application/json',\n        ...(FUNCTION_KEY ? {\n          'x-functions-key': FUNCTION_KEY\n        } : {})\n      },\n      body: JSON.stringify({\n        email,\n        name\n      })\n    });\n    const text = await response.text().catch(() => '');\n    if (!response.ok) {\n      console.warn('Azure Function email non-OK:', response.status, text);\n      return {\n        ok: false,\n        status: response.status,\n        body: text\n      };\n    }\n    return {\n      ok: true,\n      status: response.status,\n      body: text\n    };\n  } catch (err) {\n    // Erreurs typiques: CORS, réseau, DNS, SSL\n    console.warn('Erreur envoi email Azure Function:', err);\n    return {\n      ok: false,\n      error: (err === null || err === void 0 ? void 0 : err.message) || String(err)\n    };\n  }\n}\nexport default {\n  sendWelcomeEmail\n};","map":{"version":3,"names":["AZURE_FUNCTIONS","FUNCTION_KEY","process","env","REACT_APP_AZURE_FUNC_KEY","sendWelcomeEmail","email","name","url","WELCOME_EMAIL","encodeURIComponent","response","fetch","method","headers","body","JSON","stringify","text","catch","ok","console","warn","status","err","error","message","String"],"sources":["C:/Users/Hp/Desktop/Cloud_Project/frontend/src/services/emailService.js"],"sourcesContent":["import { AZURE_FUNCTIONS } from '../config/config';\r\n\r\n// Optionnel: clé d'accès de la Function (si auth level = Function)\r\n// Doit être définie dans un fichier .env du dossier frontend\r\n// Exemple: REACT_APP_AZURE_FUNC_KEY=xxxxxxxxxxxxxxxx\r\nconst FUNCTION_KEY = process.env.REACT_APP_AZURE_FUNC_KEY;\r\n\r\n/**\r\n * Envoie un email de bienvenue via l'Azure Function\r\n * N'échoue pas le flux d'inscription si l'appel échoue.\r\n */\r\nexport async function sendWelcomeEmail(email, name) {\r\n  try {\r\n    // Construire l'URL avec éventuellement la clé\r\n    const url = FUNCTION_KEY\r\n      ? `${AZURE_FUNCTIONS.WELCOME_EMAIL}?code=${encodeURIComponent(FUNCTION_KEY)}`\r\n      : AZURE_FUNCTIONS.WELCOME_EMAIL;\r\n\r\n    const response = await fetch(url, {\r\n      method: 'POST',\r\n      // Certaines Functions acceptent la clé via header\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...(FUNCTION_KEY ? { 'x-functions-key': FUNCTION_KEY } : {}),\r\n      },\r\n      body: JSON.stringify({ email, name }),\r\n    });\r\n\r\n    const text = await response.text().catch(() => '');\r\n\r\n    if (!response.ok) {\r\n      console.warn('Azure Function email non-OK:', response.status, text);\r\n      return { ok: false, status: response.status, body: text };\r\n    }\r\n\r\n    return { ok: true, status: response.status, body: text };\r\n  } catch (err) {\r\n    // Erreurs typiques: CORS, réseau, DNS, SSL\r\n    console.warn('Erreur envoi email Azure Function:', err);\r\n    return { ok: false, error: err?.message || String(err) };\r\n  }\r\n}\r\n\r\nexport default { sendWelcomeEmail };"],"mappings":"AAAA,SAASA,eAAe,QAAQ,kBAAkB;;AAElD;AACA;AACA;AACA,MAAMC,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,wBAAwB;;AAEzD;AACA;AACA;AACA;AACA,OAAO,eAAeC,gBAAgBA,CAACC,KAAK,EAAEC,IAAI,EAAE;EAClD,IAAI;IACF;IACA,MAAMC,GAAG,GAAGP,YAAY,GACpB,GAAGD,eAAe,CAACS,aAAa,SAASC,kBAAkB,CAACT,YAAY,CAAC,EAAE,GAC3ED,eAAe,CAACS,aAAa;IAEjC,MAAME,QAAQ,GAAG,MAAMC,KAAK,CAACJ,GAAG,EAAE;MAChCK,MAAM,EAAE,MAAM;MACd;MACAC,OAAO,EAAE;QACP,cAAc,EAAE,kBAAkB;QAClC,IAAIb,YAAY,GAAG;UAAE,iBAAiB,EAAEA;QAAa,CAAC,GAAG,CAAC,CAAC;MAC7D,CAAC;MACDc,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEX,KAAK;QAAEC;MAAK,CAAC;IACtC,CAAC,CAAC;IAEF,MAAMW,IAAI,GAAG,MAAMP,QAAQ,CAACO,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,EAAE,CAAC;IAElD,IAAI,CAACR,QAAQ,CAACS,EAAE,EAAE;MAChBC,OAAO,CAACC,IAAI,CAAC,8BAA8B,EAAEX,QAAQ,CAACY,MAAM,EAAEL,IAAI,CAAC;MACnE,OAAO;QAAEE,EAAE,EAAE,KAAK;QAAEG,MAAM,EAAEZ,QAAQ,CAACY,MAAM;QAAER,IAAI,EAAEG;MAAK,CAAC;IAC3D;IAEA,OAAO;MAAEE,EAAE,EAAE,IAAI;MAAEG,MAAM,EAAEZ,QAAQ,CAACY,MAAM;MAAER,IAAI,EAAEG;IAAK,CAAC;EAC1D,CAAC,CAAC,OAAOM,GAAG,EAAE;IACZ;IACAH,OAAO,CAACC,IAAI,CAAC,oCAAoC,EAAEE,GAAG,CAAC;IACvD,OAAO;MAAEJ,EAAE,EAAE,KAAK;MAAEK,KAAK,EAAE,CAAAD,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,OAAO,KAAIC,MAAM,CAACH,GAAG;IAAE,CAAC;EAC1D;AACF;AAEA,eAAe;EAAEnB;AAAiB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}